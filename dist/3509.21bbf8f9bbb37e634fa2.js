"use strict";(self.webpackChunkbuiler=self.webpackChunkbuiler||[]).push([[3509],{3509:(e,t,r)=>{r.d(t,{v:()=>O});var n=r(96540),a=r(34164),i=r(32527),l=r(1882),o=r.n(l),s=r(23181),d=r.n(s),h=r(86069),u=r(20261),c=r(33964),v=r(59744),f=r(50357),p=r(94501);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y.apply(this,arguments)}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){X(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E(n.key),n)}}function x(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(x=function(){return!!e})()}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function S(e,t){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},S(e,t)}function X(e,t,r){return(t=E(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E(e){var t=function(e){if("object"!=g(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}var M=function(e){return e.changedTouches&&!!e.changedTouches.length},O=function(e){function t(e){var r,n,a,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),X((n=this,i=[e],a=w(a=t),r=function(e,t){if(t&&("object"===g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(n,x()?Reflect.construct(a,i||[],w(n).constructor):a.apply(n,i))),"handleDrag",(function(e){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(e):r.state.isSlideMoving&&r.handleSlideDrag(e)})),X(r,"handleTouchMove",(function(e){null!=e.changedTouches&&e.changedTouches.length>0&&r.handleDrag(e.changedTouches[0])})),X(r,"handleDragEnd",(function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},(function(){var e=r.props,t=e.endIndex,n=e.onDragEnd,a=e.startIndex;null==n||n({endIndex:t,startIndex:a})})),r.detachDragEndListener()})),X(r,"handleLeaveWrapper",(function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))})),X(r,"handleEnterSlideOrTraveller",(function(){r.setState({isTextActive:!0})})),X(r,"handleLeaveSlideOrTraveller",(function(){r.setState({isTextActive:!1})})),X(r,"handleSlideDragStart",(function(e){var t=M(e)?e.changedTouches[0]:e;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:t.pageX}),r.attachDragEndListener()})),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(t,e),r=t,s=[{key:"renderDefaultTraveller",value:function(e){var t=e.x,r=e.y,a=e.width,i=e.height,l=e.stroke,o=Math.floor(r+i/2)-1;return n.createElement(n.Fragment,null,n.createElement("rect",{x:t,y:r,width:a,height:i,fill:l,stroke:"none"}),n.createElement("line",{x1:t+1,y1:o,x2:t+a-1,y2:o,fill:"none",stroke:"#fff"}),n.createElement("line",{x1:t+1,y1:o+2,x2:t+a-1,y2:o+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(e,r){return n.isValidElement(e)?n.cloneElement(e,r):o()(e)?e(r):t.renderDefaultTraveller(r)}},{key:"getDerivedStateFromProps",value:function(e,t){var r=e.data,n=e.width,a=e.x,l=e.travellerWidth,o=e.updateId,s=e.startIndex,h=e.endIndex;if(r!==t.prevData||o!==t.prevUpdateId)return T({prevData:r,prevTravellerWidth:l,prevUpdateId:o,prevX:a,prevWidth:n},r&&r.length?function(e){var t=e.data,r=e.startIndex,n=e.endIndex,a=e.x,l=e.width,o=e.travellerWidth;if(!t||!t.length)return{};var s=t.length,h=(0,i.z)().domain(d()(0,s)).range([a,a+l-o]),u=h.domain().map((function(e){return h(e)}));return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:h(r),endX:h(n),scale:h,scaleValues:u}}({data:r,width:n,x:a,travellerWidth:l,startIndex:s,endIndex:h}):{scale:null,scaleValues:null});if(t.scale&&(n!==t.prevWidth||a!==t.prevX||l!==t.prevTravellerWidth)){t.scale.range([a,a+n-l]);var u=t.scale.domain().map((function(e){return t.scale(e)}));return{prevData:r,prevTravellerWidth:l,prevUpdateId:o,prevX:a,prevWidth:n,startX:t.scale(e.startIndex),endX:t.scale(e.endIndex),scaleValues:u}}return null}},{key:"getIndexInRange",value:function(e,t){for(var r=0,n=e.length-1;n-r>1;){var a=Math.floor((r+n)/2);e[a]>t?n=a:r=a}return t>=e[n]?n:r}}],(l=[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(e){var r=e.startX,n=e.endX,a=this.state.scaleValues,i=this.props,l=i.gap,o=i.data.length-1,s=Math.min(r,n),d=Math.max(r,n),h=t.getIndexInRange(a,s),u=t.getIndexInRange(a,d);return{startIndex:h-h%l,endIndex:u===o?o:u-u%l}}},{key:"getTextOfTick",value:function(e){var t=this.props,r=t.data,n=t.tickFormatter,a=t.dataKey,i=(0,c.kr)(r[e],a,e);return o()(n)?n(i,e):i}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(e){var t=this.state,r=t.slideMoveStartX,n=t.startX,a=t.endX,i=this.props,l=i.x,o=i.width,s=i.travellerWidth,d=i.startIndex,h=i.endIndex,u=i.onChange,c=e.pageX-r;c>0?c=Math.min(c,l+o-s-a,l+o-s-n):c<0&&(c=Math.max(c,l-n,l-a));var v=this.getIndex({startX:n+c,endX:a+c});v.startIndex===d&&v.endIndex===h||!u||u(v),this.setState({startX:n+c,endX:a+c,slideMoveStartX:e.pageX})}},{key:"handleTravellerDragStart",value:function(e,t){var r=M(t)?t.changedTouches[0]:t;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:e,brushMoveStartX:r.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(e){var t=this.state,r=t.brushMoveStartX,n=t.movingTravellerId,a=t.endX,i=t.startX,l=this.state[n],o=this.props,s=o.x,d=o.width,h=o.travellerWidth,u=o.onChange,c=o.gap,v=o.data,f={startX:this.state.startX,endX:this.state.endX},p=e.pageX-r;p>0?p=Math.min(p,s+d-h-l):p<0&&(p=Math.max(p,s-l)),f[n]=l+p;var g=this.getIndex(f),y=g.startIndex,m=g.endIndex;this.setState(X(X({},n,l+p),"brushMoveStartX",e.pageX),(function(){var e;u&&(e=v.length-1,("startX"===n&&(a>i?y%c==0:m%c==0)||a<i&&m===e||"endX"===n&&(a>i?m%c==0:y%c==0)||a>i&&m===e)&&u(g))}))}},{key:"handleTravellerMoveKeyboard",value:function(e,t){var r=this,n=this.state,a=n.scaleValues,i=n.startX,l=n.endX,o=this.state[t],s=a.indexOf(o);if(-1!==s){var d=s+e;if(!(-1===d||d>=a.length)){var h=a[d];"startX"===t&&h>=l||"endX"===t&&h<=i||this.setState(X({},t,h),(function(){r.props.onChange(r.getIndex({startX:r.state.startX,endX:r.state.endX}))}))}}}},{key:"renderBackground",value:function(){var e=this.props,t=e.x,r=e.y,a=e.width,i=e.height,l=e.fill,o=e.stroke;return n.createElement("rect",{stroke:o,fill:l,x:t,y:r,width:a,height:i})}},{key:"renderPanorama",value:function(){var e=this.props,t=e.x,r=e.y,a=e.width,i=e.height,l=e.data,o=e.children,s=e.padding,d=n.Children.only(o);return d?n.cloneElement(d,{x:t,y:r,width:a,height:i,margin:s,compact:!0,data:l}):null}},{key:"renderTravellerLayer",value:function(e,r){var a,i,l=this,o=this.props,s=o.y,d=o.travellerWidth,u=o.height,c=o.traveller,v=o.ariaLabel,f=o.data,g=o.startIndex,y=o.endIndex,m=Math.max(e,this.props.x),b=T(T({},(0,p.J9)(this.props,!1)),{},{x:m,y:s,width:d,height:u}),x=v||"Min value: ".concat(null===(a=f[g])||void 0===a?void 0:a.name,", Max value: ").concat(null===(i=f[y])||void 0===i?void 0:i.name);return n.createElement(h.W,{tabIndex:0,role:"slider","aria-label":x,"aria-valuenow":e,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[r],onTouchStart:this.travellerDragStartHandlers[r],onKeyDown:function(e){["ArrowLeft","ArrowRight"].includes(e.key)&&(e.preventDefault(),e.stopPropagation(),l.handleTravellerMoveKeyboard("ArrowRight"===e.key?1:-1,r))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(c,b))}},{key:"renderSlide",value:function(e,t){var r=this.props,a=r.y,i=r.height,l=r.stroke,o=r.travellerWidth,s=Math.min(e,t)+o,d=Math.max(Math.abs(t-e)-o,0);return n.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:l,fillOpacity:.2,x:s,y:a,width:d,height:i})}},{key:"renderText",value:function(){var e=this.props,t=e.startIndex,r=e.endIndex,a=e.y,i=e.height,l=e.travellerWidth,o=e.stroke,s=this.state,d=s.startX,c=s.endX,v={pointerEvents:"none",fill:o};return n.createElement(h.W,{className:"recharts-brush-texts"},n.createElement(u.E,y({textAnchor:"end",verticalAnchor:"middle",x:Math.min(d,c)-5,y:a+i/2},v),this.getTextOfTick(t)),n.createElement(u.E,y({textAnchor:"start",verticalAnchor:"middle",x:Math.max(d,c)+l+5,y:a+i/2},v),this.getTextOfTick(r)))}},{key:"render",value:function(){var e=this.props,t=e.data,r=e.className,i=e.children,l=e.x,o=e.y,s=e.width,d=e.height,u=e.alwaysShowText,c=this.state,p=c.startX,g=c.endX,y=c.isTextActive,m=c.isSlideMoving,T=c.isTravellerMoving,b=c.isTravellerFocused;if(!t||!t.length||!(0,v.Et)(l)||!(0,v.Et)(o)||!(0,v.Et)(s)||!(0,v.Et)(d)||s<=0||d<=0)return null;var x=(0,a.A)("recharts-brush",r),w=1===n.Children.count(i),S=(0,f.t)("userSelect","none");return n.createElement(h.W,{className:x,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:S},this.renderBackground(),w&&this.renderPanorama(),this.renderSlide(p,g),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(g,"endX"),(y||m||T||b||u)&&this.renderText())}}])&&b(r.prototype,l),s&&b(r,s),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,l,s}(n.PureComponent);X(O,"displayName","Brush"),X(O,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1})}}]);